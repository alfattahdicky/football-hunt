{"version":3,"sources":["script/sw-register.js"],"names":["requestPermission","window","Notification","then","result","navigator","serviceWorker","getRegistration","registration","pushManager","subscribe","userVisibleOnly","applicationServerKey","urlBase64ToUint8Array","catch","e","console","log","message","error","base64String","padding","base64","repeat","length","replace","rawData","atob","outputArray","Uint8Array","i","charCodeAt","addEventListener","register"],"mappings":";AAkBA,SAASA,IACJ,iBAAkBC,QACnBC,aAAaF,oBAAoBG,KAAK,SAAAC,GACtB,WAAXA,EAGkB,YAAXA,EAON,gBAAiBH,QACnBI,UAAUC,cAAcC,kBAAkBJ,KAAK,SAAAK,GAC7CA,EAAaC,YAAYC,UAAU,CACjCC,iBAAiB,EAEjBC,qBAAsBC,EAAsB,6FAC3CV,KAAK,SAAAO,MAILI,MAAM,SAAAC,GAAKC,OAAAA,QAAQC,IAAI,kCAAmCF,EAAEG,aAhBjEF,QAAQG,MAAM,kDAHdH,QAAQC,IAAI,sCA0BpB,SAASJ,EAAsBO,GAOzB,IANEC,IACAC,GAAUF,EADA,IAAIG,QAAQ,EAAEH,EAAaI,OAAS,GAAK,IAEtDC,QAAQ,KAAK,KACbA,QAAQ,KAAK,KACVC,EAAUzB,OAAO0B,KAAKL,GACtBM,EAAc,IAAIC,WAAWH,EAAQF,QACnCM,EAAI,EAAGA,EAAIJ,EAAQF,SAAUM,EACnCF,EAAYE,GAAKJ,EAAQK,WAAWD,GAE/BF,OAAAA,EAzDL,kBAAmBvB,UACrBJ,OAAO+B,iBAAiB,OAAQ,WAC9B3B,UAAUC,cACP2B,SAAS,wCACT9B,KAAK,WACJa,QAAQC,IAAI,wCAEbH,MAAM,WACLE,QAAQC,IAAI,qCAEhBjB,MAGFgB,QAAQC,IAAI","file":"sw-register.bca9f485.js","sourceRoot":"..\\src","sourcesContent":["// REGISTER SERVICE WORKER\r\nif (\"serviceWorker\" in navigator) {\r\n  window.addEventListener(\"load\", function() {\r\n    navigator.serviceWorker\r\n      .register(\"/service-worker.js\")\r\n      .then(function() {\r\n        console.log(\"Pendaftaran ServiceWorker berhasil\");\r\n      })\r\n      .catch(function() {\r\n        console.log(\"Pendaftaran ServiceWorker gagal\");\r\n      });\r\n    requestPermission();\r\n  });\r\n} else {\r\n  console.log(\"ServiceWorker belum didukung browser ini.\");\r\n}\r\n\r\n// Notification\r\nfunction requestPermission() {\r\n  if('Notification' in window) {\r\n    Notification.requestPermission().then(result => {\r\n      if(result === 'denied') {\r\n        console.log('Fitur notifikasi tidak diizinkan');\r\n        return;\r\n      } else if(result === \"default\") {\r\n        console.error(\"Pengguna menutup kotak dialog permintaan izin.\");\r\n        return;\r\n      }\r\n      // navigator.serviceWorker.getRegistration().then(reg =>{\r\n      //   reg.showNotification(\"Notifikasi Diizinkan\");\r\n      // })\r\n      if(('PushManager' in window)) {\r\n        navigator.serviceWorker.getRegistration().then(registration => {\r\n          registration.pushManager.subscribe({\r\n            userVisibleOnly: true,\r\n            // gunakan public key\r\n            applicationServerKey: urlBase64ToUint8Array(\"BGGEoB87IK1d1Np4-cjWbBsvNQ4Lh8Z8mWvD9hr2FYk0FjY_hgaDa8aJhc3-q9dUbZArGe9_WyaPpXR8UJOCNDQ\")\r\n          }).then(subscribe => {\r\n            // console.log('Berhasil melakukan subscribe dengan endpoint', subscribe.endpoint);\r\n            // console.log('Berhasil melakukan subscribe dengan p256dh key:', btoa(String.fromCharCode.apply(null, new Uint8Array(subscribe.getKey('p256dh')))));\r\n            // console.log('Berhasil melakukan subscribe dengan auth key: ', btoa(String.fromCharCode.apply(null, new Uint8Array(subscribe.getKey('auth')))));\r\n          }).catch(e => console.log('Tidak dapat melakukan subscribe', e.message));\r\n        })\r\n      }\r\n    })\r\n  }\r\n}\r\n// Mengubah string menjadi Uint8Array\r\nfunction urlBase64ToUint8Array(base64String) {\r\n  const padding = '='.repeat((4-base64String.length % 4) % 4);\r\n  const base64 = (base64String + padding)\r\n    .replace(/-/g,'+')\r\n    .replace(/_/g,'/');\r\n  const rawData = window.atob(base64);\r\n  const outputArray = new Uint8Array(rawData.length);\r\n  for(let i = 0; i < rawData.length; ++i) {\r\n    outputArray[i] = rawData.charCodeAt(i);\r\n  }\r\n  return outputArray;\r\n}"]}